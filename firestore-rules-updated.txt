// Add this rule after the local_branch_withdrawal_requests rule in your Firebase Console:

// Driver Withdrawal Requests collection
match /driver_withdrawal_requests/{requestId} {
  allow read: if isAuthenticated() && (
    isSuperAdmin() ||
    isCountryAgent() ||
    isCityAgent() ||
    request.auth.uid == resource.data.driver_id ||
    request.auth.uid == resource.data.country_agent_id ||
    // Allow admin to see all withdrawal requests
    request.auth.token.email == "elitelaundryworldwide@gmail.com"
  );
  
  allow create: if isAuthenticated() && (
    isDriver() ||
    request.auth.uid == request.resource.data.driver_id
  );
  
  allow update: if isAuthenticated() && (
    isSuperAdmin() ||
    isCountryAgent() ||
    isCityAgent() ||
    request.auth.uid == resource.data.country_agent_id ||
    // Allow admin to approve/reject requests
    request.auth.token.email == "elitelaundryworldwide@gmail.com"
  );
  
  allow delete: if isSuperAdmin();
}
